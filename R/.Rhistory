cl2 = 32
maxit = 1000
SB_when = 2010.75
SB    = match(SB_when, Years)
# panel rotation  ---------------------------------------------------------
cores = parallel::detectCores()-1
set.seed(1234)
source('model_id1.R')
# saveRDS(P_Q_dc, paste0('./out/P_Q_', SB, '_K4.rds'))
# P_Q_dc = readRDS( paste0('./out/P_Q_', SB, '_K4.rds'))
Q1 = diag_max(P_Q_dc$pool_1)
Q2 = diag_max(P_Q_dc$pool_2)
# -------------------------------------------------------------------------
resids_boot = readRDS(paste0('./out/resids_boot_sb_', SB, '_K4.rds'))
P_Q_dc_boot = readRDS(paste0('./out/P_Q_dc_boot_sb_', SB, '_K4.rds'))
.get_AB = function(x, Q, Reorder = FALSE){
Q = diag_max(Q)
B_foo =  x$chol %*% Q
if(Reorder){
sign_mat = matrix(c(1, -1, 1, 1), nrow = 2, ncol = 2)
if(all(sign(B_foo[1:2,1:2])== sign_mat)){
B_foo[,c(1,2)] = B_foo[,c(2,1)]
B_foo[, 2] = B_foo[, 2]*-1
}
}
list('Bmat' = .postiv_sign(B_foo),
'Amat' = x$A_hat )
}
Bmats_pool1 = Bmats_pool2 = list()
for (b in 1:nboot) {
Bmats_pool1[[b]] = resids_boot[[b]] %>% lapply(.get_AB, Q = P_Q_dc_boot[[b]]$pool_1)
Bmats_pool2[[b]] = resids_boot[[b]] %>% lapply(.get_AB, Q = P_Q_dc_boot[[b]]$pool_2)
}
# grouping ----------------------------------------------------------------
Countries_U = c("Germany", "France", "Italy", "Spain", "Netherlands", "Belgium", "Austria")
# boot --------------------------------------------------------------------
# Years  = seq(from = 2001, to = 2020, by = 0.25)
nboot = 499
idx   = 1:length(models)
# -------------------------------------------------------------------------
resids_boot = readRDS(paste0('./out/resids_boot_sb_', SB, '_K4.rds'))
P_Q_dc_boot = readRDS(paste0('./out/P_Q_dc_boot_sb_', SB, '_K4.rds'))
.get_AB = function(x, Q, Reorder = FALSE){
Q = diag_max(Q)
B_foo =  x$chol %*% Q
if(Reorder){
sign_mat = matrix(c(1, -1, 1, 1), nrow = 2, ncol = 2)
if(all(sign(B_foo[1:2,1:2])== sign_mat)){
B_foo[,c(1,2)] = B_foo[,c(2,1)]
B_foo[, 2] = B_foo[, 2]*-1
}
}
list('Bmat' = .postiv_sign(B_foo),
'Amat' = x$A_hat )
}
Bmats_pool1 = Bmats_pool2 = list()
for (b in 1:nboot) {
Bmats_pool1[[b]] = resids_boot[[b]] %>% lapply(.get_AB, Q = P_Q_dc_boot[[b]]$pool_1)
Bmats_pool2[[b]] = resids_boot[[b]] %>% lapply(.get_AB, Q = P_Q_dc_boot[[b]]$pool_2)
}
# grouping ----------------------------------------------------------------
Countries_U = c("Germany", "France", "Italy", "Spain", "Netherlands", "Belgium", "Austria")
Countries_L = c("Greece", "Portugal", "Finland", "Luxembourg", "Slovenia", "Cyprus", "Malta")
idx_U = match(Countries_U, Countries)
idx_L = match(Countries_L, Countries)
Bmats_U1 = Bmats_pool1 %>% lapply('[', idx_U)
Bmats_L1 = Bmats_pool1 %>% lapply('[', idx_L)
Bmats_U2 = Bmats_pool2 %>% lapply('[', idx_U)
Bmats_L2 = Bmats_pool2 %>% lapply('[', idx_L)
# MG irf ------------------------------------------------------------------
source('do_irf_MG_K4.R')
irf_MG_boot
if (x == 0){irf_MG_boot = irf_MG_boot} else if (x == 1){
irf_MG_boot = irf_MG_boot1} else if (x == 2){
irf_MG_boot = irf_MG_boot2} else if (x == "U1"){
irf_MG_boot = irf_MG_boot_U1} else if (x == "U2"){
irf_MG_boot = irf_MG_boot_U2}  else if (x == "L1"){
irf_MG_boot = irf_MG_boot_L1}  else if (x == "L2"){
irf_MG_boot = irf_MG_boot_L2}   else if (x == "U"){
irf_MG_boot = irf_MG_boot_U } else if (x == "L"){
irf_MG_boot = irf_MG_boot_L } else {stop('unvalid argument!') }
# MG irf ------------------------------------------------------------------
source('do_irf_MG_K4.R')
irf_MG_boot1
irf_MG_boot1 %>% dim
irf_MG_boot1 %>% length
rf_MG_boot = irf_MG_boot1
irf_flat = matrix(NA, nrow = nboot, ncol = 21*4*4)
for (b in 1:nboot) {
foo = irf_MG_boot[[b]] %>% unlist %>% matrix(nrow = 21, ncol = 4*4) %>% as.data.frame %>% plot_irf_K4( )
faa = foo$data %>% .rescale_xpi_V4
irf_flat[b,] = faa$value
}
irf_MG_boot
irf_MG_boot = irf_MG_boot1
irf_flat = matrix(NA, nrow = nboot, ncol = 21*4*4)
for (b in 1:nboot) {
foo = irf_MG_boot[[b]] %>% unlist %>% matrix(nrow = 21, ncol = 4*4) %>% as.data.frame %>% plot_irf_K4( )
faa = foo$data %>% .rescale_xpi_V4
irf_flat[b,] = faa$value
}
foo
foo
irf_MG_boot[[b]] %>% unlist %>% matrix(nrow = 21, ncol = 4*4) %>% as.data.frame
irf_MG_boot[[b]] %>% unlist %>% matrix(nrow = 21, ncol = 4*4) %>% as.data.frame
irf_MG_boot[[b]] %>% unlist %>% matrix(nrow = 21, ncol = 4*4) %>% as.data.frame %>% plot_irf_K4( )
irf_MG_boot[[b]] %>% unlist %>% matrix(nrow = 21, ncol = 4*4)
fa
faa
foo
plot_irf_K4 = function(dat, variable = c('x', 'pi', 'r', 'f'),  cum = T){
if(cum){dat = dat %>% .cum_irf_12_K4}
h = 0:(nrow(dat)-1)
dat = data.frame(h, dat) %>% reshape2::melt('h')
dat$variable = factor(dat$variable, levels = c('V1', 'V5', 'V9', 'V13',
'V2', 'V6', 'V10', 'V14',
'V3', 'V7', 'V11', 'V15',
'V4', 'V8', 'V12', 'V16'))
my_labeller <- as_labeller(c(V1 = paste("xi[",1,"]", "%->%", variable[1]),
V2 = paste("xi[",1,"]", "%->%", variable[2]),
V3 = paste("xi[",1,"]", "%->%", variable[3]),
V4 = paste("xi[",1,"]", "%->%", variable[4]),
V5 = paste("xi[",2,"]", "%->%", variable[1]),
V6 = paste("xi[",2,"]", "%->%", variable[2]),
V7 = paste("xi[",2,"]", "%->%", variable[3]),
V8 = paste("xi[",2,"]", "%->%", variable[4]),
V9 = paste("xi[m]", "%->%", variable[1]),
V10 = paste("xi[m]", "%->%", variable[2]),
V11 = paste("xi[m]", "%->%", variable[3]),
V12 = paste("xi[m]", "%->%", variable[4]),
V13 = paste("xi[f]", "%->%", variable[1]),
V14 = paste("xi[f]", "%->%", variable[2]),
V15 = paste("xi[f]", "%->%", variable[3]),
V16 = paste("xi[f]", "%->%", variable[4])),
default = label_parsed)
dat %>% ggplot(aes(x = h, y = value)) + geom_line() + geom_hline(yintercept = 0, color = 'red') +
facet_wrap(~variable, scales = "free_y", ncol = 4, labeller = my_labeller) + xlab(" ") + ylab(" ") +
theme_bw()
}
for (b in 1:nboot) {
foo = irf_MG_boot[[b]] %>% unlist %>% matrix(nrow = 21, ncol = 4*4) %>% as.data.frame %>% plot_irf_K4( )
faa = foo$data %>% .rescale_xpi_V4
irf_flat[b,] = faa$value
}
foo = irf_MG_boot[[b]] %>% unlist %>% matrix(nrow = 21, ncol = 4*4) %>% as.data.frame %>% plot_irf_K4( )
foo
foo$data
# test --------------------------------------------------------------------
irf_MG_boot[[sample(1:nboot, 1)]] %>% unlist %>% matrix(nrow = 21, ncol = 4*4) %>% as.data.frame %>% plot_irf_K4( )
# test --------------------------------------------------------------------
irf_MG_boot[[sample(1:nboot, 1)]] %>% unlist %>% matrix(nrow = 21, ncol = 4*4) %>% as.data.frame %>% plot_irf_K4( )
plot_irf_K4 = function(dat, variable = c('x', 'pi', 'r', 'f'),  cum =F ){
if(cum){dat = dat %>% .cum_irf_12_K4}
h = 0:(nrow(dat)-1)
dat = data.frame(h, dat) %>% reshape2::melt('h')
dat$variable = factor(dat$variable, levels = c('V1', 'V5', 'V9', 'V13',
'V2', 'V6', 'V10', 'V14',
'V3', 'V7', 'V11', 'V15',
'V4', 'V8', 'V12', 'V16'))
my_labeller <- as_labeller(c(V1 = paste("xi[",1,"]", "%->%", variable[1]),
V2 = paste("xi[",1,"]", "%->%", variable[2]),
V3 = paste("xi[",1,"]", "%->%", variable[3]),
V4 = paste("xi[",1,"]", "%->%", variable[4]),
V5 = paste("xi[",2,"]", "%->%", variable[1]),
V6 = paste("xi[",2,"]", "%->%", variable[2]),
V7 = paste("xi[",2,"]", "%->%", variable[3]),
V8 = paste("xi[",2,"]", "%->%", variable[4]),
V9 = paste("xi[m]", "%->%", variable[1]),
V10 = paste("xi[m]", "%->%", variable[2]),
V11 = paste("xi[m]", "%->%", variable[3]),
V12 = paste("xi[m]", "%->%", variable[4]),
V13 = paste("xi[f]", "%->%", variable[1]),
V14 = paste("xi[f]", "%->%", variable[2]),
V15 = paste("xi[f]", "%->%", variable[3]),
V16 = paste("xi[f]", "%->%", variable[4])),
default = label_parsed)
dat %>% ggplot(aes(x = h, y = value)) + geom_line() + geom_hline(yintercept = 0, color = 'red') +
facet_wrap(~variable, scales = "free_y", ncol = 4, labeller = my_labeller) + xlab(" ") + ylab(" ") +
theme_bw()
}
# test --------------------------------------------------------------------
irf_MG_boot[[sample(1:nboot, 1)]] %>% unlist %>% matrix(nrow = 21, ncol = 4*4) %>% as.data.frame %>% plot_irf_K4( )
irf_MG_boot[[sample(1:nboot, 1)]] %>% unlist %>% matrix(nrow = 21, ncol = 4*4) %>% as.data.frame %>% plot_irf_K4( )
irf_MG_boot[[sample(1:nboot, 1)]] %>% unlist %>% matrix(nrow = 21, ncol = 4*4) %>% as.data.frame %>% plot_irf_K4( )
b = sample(1:nboot, 1)
Bmats_pool1[[b]]
irf_MG_boot[[b]] %>% unlist %>% matrix(nrow = 21, ncol = 4*4) %>% as.data.frame %>% plot_irf_K4( )
Bmats_pool1[[b]] %>% lapply('[[',1)
Bmats_pool1[[b]] %>% lapply('[[',1) %>% lapply('[[',9)
# test --------------------------------------------------------------------
b = sample(1:nboot, 1)
Bmats_pool1[[b]] %>% lapply('[[',1) %>% lapply('[[',9) %>% unlist %>% mean
irf_MG_boot[[b]] %>% unlist %>% matrix(nrow = 21, ncol = 4*4) %>% as.data.frame %>% plot_irf_K4( )
x = Bmats_pool1
bbb = x %>% lapply('[[', 1)
faa = x %>% lapply('[[', 2)
bbb
faa
bbb
x
x = Bmats_pool1[[1]]
bbb = x %>% lapply('[[', 1)
faa = x %>% lapply('[[', 2)
bbb
faa
bbb
irf_flat = matrix(NA, nrow = length(bbb), ncol = 21*4*4)
length(bbb)
i = 1
foo = IRF_fast(A_hat = faa[[i]], B_hat = bbb[[i]], horizon = 21)
foo
dat = foo %>% sapply(function(x) x) %>% t
dat
if (normalize){
dat[,9] = dat[,9] /dat[1,9] * 0.25
mp_norm = dat[1,11] / 0.25
# mp_norm = 1
dat[,9] = dat[,9] /mp_norm
dat[,10] = dat[,10] /mp_norm
dat[,11] = dat[,11] /mp_norm
dat[,12] = dat[,12] /mp_norm
bs_norm = dat[1,16] / 0.25
# bs_norm = 1
dat[,13] = dat[,13] /bs_norm
dat[,14] = dat[,14] /bs_norm
dat[,15] = dat[,15] /bs_norm
dat[,16] = dat[,16] /bs_norm
}
dat[,9] = dat[,9] /dat[1,9] * 0.25
mp_norm = dat[1,11] / 0.25
# mp_norm = 1
dat[,9] = dat[,9] /mp_norm
dat[,10] = dat[,10] /mp_norm
dat[,11] = dat[,11] /mp_norm
dat[,12] = dat[,12] /mp_norm
bs_norm = dat[1,16] / 0.25
# bs_norm = 1
dat[,13] = dat[,13] /bs_norm
dat[,14] = dat[,14] /bs_norm
dat[,15] = dat[,15] /bs_norm
dat[,16] = dat[,16] /bs_norm
dat
foo = IRF_fast(A_hat = faa[[i]], B_hat = bbb[[i]], horizon = 21)
dat = foo %>% sapply(function(x) x) %>% t
dat[1,9] * 0.25
.get_MG_boot_K4 = function(x, normalize = T)
{
bbb = x %>% lapply('[[', 1)
faa = x %>% lapply('[[', 2)
irf_flat = matrix(NA, nrow = length(bbb), ncol = 21*4*4)
for (i in 1:length(bbb)) {
foo = IRF_fast(A_hat = faa[[i]], B_hat = bbb[[i]], horizon = 21)
dat = foo %>% sapply(function(x) x) %>% t
if (normalize){
# dat[,9] = dat[,9] /dat[1,9] * 0.25
mp_norm = dat[1,11] / 0.25
# mp_norm = 1
dat[,9] = dat[,9] /mp_norm
dat[,10] = dat[,10] /mp_norm
dat[,11] = dat[,11] /mp_norm
dat[,12] = dat[,12] /mp_norm
bs_norm = dat[1,16] / 0.25
# bs_norm = 1
dat[,13] = dat[,13] /bs_norm
dat[,14] = dat[,14] /bs_norm
dat[,15] = dat[,15] /bs_norm
dat[,16] = dat[,16] /bs_norm
}
irf_flat[i,] = dat %>% .norm_irf_3 %>% unlist %>%  matrix(nrow = 1)
}
irf_mean_raw = irf_flat %>% colMeans() %>% matrix(nrow = 21, ncol = 16) %>% as.data.frame
}
# MG irf ------------------------------------------------------------------
source('do_irf_MG_K4.R')
ip1 = plot_irf_MG_boot_K4(1, modes = 'med', bands = 'areas') + ggtitle('Pre 2011') +  theme(plot.title = element_text(size = 10))
ip2 = plot_irf_MG_boot_K4(2, modes = 'med', bands = 'areas') + ggtitle('Post 2011') +  theme(plot.title = element_text(size = 10))
require(gridExtra)
margin = theme(plot.margin = unit(c(1, 1, -4, 0), "mm"))
out    = grid.arrange(grobs = lapply(list(ip1, ip2), "+", margin))
# MG irf ------------------------------------------------------------------
source('do_irf_MG_K4.R')
ip1_part = plot_irf_MG_boot_K4(1, modes = 'med', bands = 'areas', partial = T) + ggtitle('PCP') +  theme(plot.title = element_text(size = 10))
ip2_part = plot_irf_MG_boot_K4(2, modes = 'med', bands = 'areas', partial = T) + ggtitle('PMP') +  theme(plot.title = element_text(size = 10))
require(gridExtra)
margin  = theme(plot.margin = unit(c(1, 1, -4, 0), "mm"))
out_part = grid.arrange(grobs = lapply(list(ip1_part, ip2_part), "+", margin), ncol = 2)
out_part %>% plot
rm(list = ls())
start_time = Sys.time()
# reduced form ------------------------------------------------------------
vartype = 'all'
p_man   = rep(NA, 14)
# trade ge
p_man[c(4, 6:8, 10:13)] = 2
p_man[6:7] = 3
Subset  = NULL
K = 4
source('model_est_sub.R')
# print(Countries)
# print(lapply(models, '[[', 3) %>% unlist)
# id0 ---------------------------------------------------------------------
cores = parallel::detectCores()
maxit = 10000
set.seed(12345)
source('model_id0_K4.R')
Q = P_Q_dc$all
# dcov
dcov
# boot --------------------------------------------------------------------
nboot = 499
idx   = 1:length(models)
resids_boot = readRDS('out/resids_boot_K4.rds')
P_Q_dc_boot = readRDS('out/P_Q_dc_boot_K4.rds')
diag_max = function(y, positive = TRUE){
.sum_diag = function(x, Q){
sum(abs(diag(Q[,x])))
}
.postiv_sign = function(x){
for (kk in 1:ncol(x)) {
if (x[kk,kk]<0) {
x[,kk] = x[,kk] * -1
}
}
x
}
K = ncol(y)
column_id = combinat::permn(K)
optim_id = which.max(lapply(column_id, .sum_diag, Q = y))
.postiv_sign(y[,column_id[[optim_id]]])
}
.get_AB = function(x, Q, Reorder = FALSE){
Q = diag_max(Q)
B_foo =  x$chol %*% Q
if(Reorder){
sign_mat = matrix(c(1, -1, 1, 1), nrow = 2, ncol = 2)
if(all(sign(B_foo[1:2,1:2])== sign_mat)){
B_foo[,c(1,2)] = B_foo[,c(2,1)]
B_foo[, 2] = B_foo[, 2]*-1
}
}
list('Bmat' = .postiv_sign(B_foo),
'Amat' = x$A_hat )
}
Bmats_pool = list()
for (b in 1:nboot) {
Bmats_pool[[b]] = resids_boot[[b]] %>% lapply(.get_AB, Q = P_Q_dc_boot[[b]]$all)
}
rm('resids_boot')
# get boot mean -----------------------------------------------------------
# source('makeB_boots.R')
Bmats_MG = Bmat_MG(Bmats_pool, K = K)
source('do_irf_MG_K4.R')
out = plot_irf_MG_boot_K4(0, modes = 'med', bands = 'areas')
out
source('do_irf_MG_K4.R')
out = plot_irf_MG_boot_K4(0, modes = 'med', bands = 'areas')
out
out
rm(list = ls())
Rcpp::sourceCpp('funs/IRF.cpp')
source('funs/IRF_cum.R')
# reduced form ------------------------------------------------------------
vartype = 'all'
p_man   = rep(NA, 14)
# benchmark
# p_man[c(2, 3, 7, 8, 10:13)] = 2
# diff
p_man[c(3, 4:10, 12:13)] = 2
p_man[12] = 3
Subset  = NULL
K = 4
source('model_est_sub.R')
print(Countries)
models %>% lapply('[[', 3) %>% unlist
# panel rotation  ---------------------------------------------------------
cores = parallel::detectCores()
maxit = 25000
set.seed(12345)
source('model_id0_K4.R')
.get_B = function(x){
Q = P_Q_dc$all
Q = diag_max(Q)
B_foo =  x$chol %*% Q
.postiv_sign(B_foo) #%>% solve()
}
Bmats = resids %>% lapply(.get_B)
# impuse responses --------------------------------------------------------
horizon = 21
irf_all = list()
for (i in 1:length(Bmats)) {
foo = IRF_fast(A_hat = resids[[i]]$A_hat, B_hat = Bmats[[i]], horizon = 21)
dat = foo %>% sapply(function(x) x) %>% t
irf_all[[i]] = dat #%>% .cum_irf_1_K4
}
Target = 9
.get_cumip = function(x, r, t){
sum(x[r,t])
}
cumip = irf_all %>% lapply(.get_cumip, r = 1:9, t = Target) %>% unlist
make_scatter_0 = function(Control = c("g_debt",
"g_exp",
"trade",
"p_debt",
"pd2inc",
"inv_hh",
"inv_nf",
"top20",
"bot40",
"NIE",
"equity"), Target){
Range = list(0:9, 10:21)
.get_cumip = function(x, r, t){
sum(x[r,t])
}
require(xts)
load('data/panals/panel_euro_14_controll.RData')
if (Control == 'g_debt'){
c_pre    = debt_ratio %>%  colMeans(na.rm = T)
xlab     = 'Government debt to GDP ratio (%)'
} else if  (Control == 'g_exp'){
c_pre      = ge %>% colMeans(na.rm = T)
xlab = 'Government expenditure to GDP ratio (%)'
} else if  (Control == 'trade'){
c_pre   = ratio_trade %>% colMeans(na.rm = T)
xlab = 'Import plus export to GDP ratio (%)'
} else if  (Control == 'p_debt'){
c_pre    = pdebt %>% colMeans(na.rm = T)
xlab = 'Debt of private sector to GDP ratio (%)'
} else if  (Control == 'inv_hh'){
c_pre    = inv_hh %>% colMeans(na.rm = T)
xlab = 'Gross investment rate of households (%)'
} else if  (Control == 'inv_nf'){
c_pre    = inv_nf %>% colMeans(na.rm = T)
xlab = 'Gross investment rate of non-financial corporations (%)'
} else if  (Control == 'pd2inc'){
c_pre    = pd2inc %>% colMeans(na.rm = T)
xlab = 'Debt-to-income ratio of households  (%)'
} else if  (Control == 'top20'){
c_pre    = top20 %>% colMeans(na.rm = T)
xlab = 'Income share of the top 20 % of the population (%)'
} else if  (Control == 'bot40'){
c_pre    = bot40 %>% colMeans(na.rm = T)
xlab = 'Income share of the bottom 40 % of the population (%)'
} else if  (Control == 'NIE'){
c_pre    = NIE %>% colMeans(na.rm = T)
xlab = 'Net interest rate exposure of households as % of GDP'
} else if  (Control == 'equity'){
c_pre    = equity %>% colMeans(na.rm = T)
xlab = 'Equity and investment fund shares of households as % of GDP'
}
c_var       = data.frame(1:14, c_pre)
colnames(c_var)   = c('countries', 'controll')
c_var       = c_var %>% reshape2::melt(id.vars = c("countries"), value.name = 'controll')
c_var = c_var[,-2]
cumip  = matrix(NA, nrow = 14, ncol = length(Range))
for (i in 1:length(Range)) {
cumip[,i]   = irf_all  %>% lapply(.get_cumip, r = Range[[i]], t = Target) %>% unlist
}
colnames(cumip)  = c('Horizon: 0 - 9 ', 'Horizon: 10 - 21')
df1 = cumip %>% reshape2::melt()
colnames(df1)  = c('countries', 'h', 'value')
df = df1 %>% dplyr::left_join(c_var, by = c('countries'))
require(ggpubr)
df %>% ggscatter(x = "controll", y = "value") + #, add = "reg.line", conf.int = TRUE) +
stat_cor(method = 'pearson', color = "black", p.accuracy = 0.001, r.accuracy = 0.01, label.y.npc = "bottom", cor.coef.name = "rho") +
facet_grid(~h) +
geom_smooth(method=lm, formula = y ~ x, alpha = 0.2) +
xlab(xlab) + ylab("Cumulated responses") + theme_bw() + theme(legend.position = 'bottom', legend.title = element_blank())
}
# output response to MP ---------------------------------------------------
## debt
make_scatter_0(Control = 'g_debt', Target = 9) #******
## - net interest rate exposure
make_scatter_0(Control = "NIE", Target = 9)
## Financial balance sheets
## - equity and investment fund shares
make_scatter_0(Control = "equity", Target = 9)
## inequality
make_scatter_0(Control = "top20", Target = 9)
make_scatter_0(Control = "bot40", Target = 9)
make_scatter_0(Control = 'p_debt', Target = 9)
make_scatter_0(Control = 'pd2inc', Target = 9)
## investment
make_scatter_0(Control = "inv_hh", Target = 9)
## goverment exp
make_scatter_0(Control = "g_exp", Target = 9)
## investment
make_scatter_0(Control = "inv_hh", Target = 9)
make_scatter_0(Control = "inv_nf", Target = 9)
# output response to MP ---------------------------------------------------
## debt
make_scatter_0(Control = 'g_debt', Target = 9) #******
## inequality
make_scatter_0(Control = "top20", Target = 9)
make_scatter_0(Control = "bot40", Target = 9)
## Financial balance sheets
## - equity and investment fund shares
make_scatter_0(Control = "equity", Target = 9)
## Financial balance sheets
## - equity and investment fund shares
make_scatter_0(Control = "equity", Target = 9)
## - net interest rate exposure
make_scatter_0(Control = "NIE", Target = 9)
## inequality
make_scatter_0(Control = "top20", Target = 9)
setwd("~/ownCloud/mp_tvp/R")
rm(list = ls())
source('./rfun/simu_DGP.R')
# Get parameters of VAR(2) ------------------------------------------------
# Autoregressive parameter: B1, B2 in our paper
Par$A_1
Par
